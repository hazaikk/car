{% extends "admin/base_site.html" %}
{% load i18n admin_urls static %}

{% block title %}{{ title }} | {{ site_title|default:_('Django site admin') }}{% endblock %}

{% block breadcrumbs %}
<div class="breadcrumbs">
<a href="{% url 'admin:index' %}">{% trans 'Home' %}</a>
&rsaquo; <a href="{% url 'admin:app_list' app_label=opts.app_label %}">{{ opts.app_config.verbose_name }}</a>
&rsaquo; <a href="{% url 'admin:crawler_crawlertask_changelist' %}">{{ opts.verbose_name_plural|capfirst }}</a>
&rsaquo; {{ title }}
</div>
{% endblock %}

{% block content %}
<div id="content-main">
    <div class="module">
        <h2>{{ title }}</h2>
        
        <div class="results">
            <div class="info">
                <p><strong>ä»»åŠ¡ä¿¡æ¯ï¼š</strong></p>
                <ul>
                    <li>ä»»åŠ¡åç§°ï¼š{{ task.name }}</li>
                    <li>ç›®æ ‡æ•°é‡ï¼š{{ task.target_count }}</li>
                    <li>å®é™…çˆ¬å–ï¼š{{ task.actual_count }}</li>
                    <li>ä»»åŠ¡çŠ¶æ€ï¼š{{ task.get_status_display }}</li>
                    <li>åˆ›å»ºæ—¶é—´ï¼š{{ task.created_at|date:"Y-m-d H:i:s" }}</li>
                    {% if task.start_time %}<li>å¼€å§‹æ—¶é—´ï¼š{{ task.start_time|date:"Y-m-d H:i:s" }}</li>{% endif %}
                    {% if task.end_time %}<li>ç»“æŸæ—¶é—´ï¼š{{ task.end_time|date:"Y-m-d H:i:s" }}</li>{% endif %}
                </ul>
            </div>
            
            {% if total_count > 0 %}
            <div class="actions">
                <p><strong>æ•°æ®æ“ä½œï¼š</strong></p>
                <a href="{% url 'admin:crawler_crawlertask_export' task.id %}" class="button" style="background-color: #6c757d; color: white; padding: 8px 15px; text-decoration: none; border-radius: 3px; margin-right: 10px;">å¯¼å‡ºå…¨éƒ¨æ•°æ®åˆ°Excel</a>
                <a href="{% url 'admin:crawler_crawlertask_import' task.id %}" class="button" style="background-color: #007bff; color: white; padding: 8px 15px; text-decoration: none; border-radius: 3px; margin-right: 10px;" onclick="return confirm('ç¡®å®šè¦å°†è¿™äº›æ•°æ®å¯¼å…¥åˆ°æ•°æ®åº“å—ï¼Ÿ');">å¯¼å…¥æ•°æ®åˆ°æ•°æ®åº“</a>
                <a href="{% url 'admin:crawler_usedcar_changelist' %}" class="button" style="background-color: #17a2b8; color: white; padding: 8px 15px; text-decoration: none; border-radius: 3px;">æŸ¥çœ‹äºŒæ‰‹è½¦æ•°æ®</a>
            </div>
            
            <div class="data-summary">
                <p><strong>æ•°æ®æ¦‚è§ˆï¼š</strong>å…± {{ total_count }} æ¡æ•°æ®{% if total_count > 100 %}ï¼ˆä¸‹æ–¹ä»…æ˜¾ç¤ºå‰100æ¡ï¼‰{% endif %}</p>
            </div>
            
            <div class="data-table" style="overflow-x: auto; margin-top: 20px;">
                <table class="table" style="width: 100%; border-collapse: collapse;">
                    <thead>
                        <tr style="background-color: #f8f9fa;">
                            <th style="border: 1px solid #dee2e6; padding: 8px; text-align: left;">åºå·</th>
                            <th style="border: 1px solid #dee2e6; padding: 8px; text-align: left;">è½¦è¾†åç§°</th>
                            <th style="border: 1px solid #dee2e6; padding: 8px; text-align: left;">ä»·æ ¼</th>
                            <th style="border: 1px solid #dee2e6; padding: 8px; text-align: left;">å¹´ä»½</th>
                            <th style="border: 1px solid #dee2e6; padding: 8px; text-align: left;">é‡Œç¨‹</th>
                            <th style="border: 1px solid #dee2e6; padding: 8px; text-align: left;">æ’é‡</th>
                            <th style="border: 1px solid #dee2e6; padding: 8px; text-align: left;">å˜é€Ÿç®±</th>
                            <th style="border: 1px solid #dee2e6; padding: 8px; text-align: left;">æ‰€åœ¨åœ°</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for item in data %}
                        <tr>
                            <td style="border: 1px solid #dee2e6; padding: 8px;">{{ forloop.counter }}</td>
                            <td style="border: 1px solid #dee2e6; padding: 8px;">{{ item.è½¦è¾†åç§°|default:"-" }}</td>
                            <td style="border: 1px solid #dee2e6; padding: 8px; color: #dc3545; font-weight: bold;">{{ item.ä»·æ ¼|default:"-" }}</td>
                            <td style="border: 1px solid #dee2e6; padding: 8px;">{{ item.å¹´ä»½|default:"-" }}</td>
                            <td style="border: 1px solid #dee2e6; padding: 8px;">{{ item.é‡Œç¨‹|default:"-" }}</td>
                            <td style="border: 1px solid #dee2e6; padding: 8px;">{{ item.æ’é‡|default:"-" }}</td>
                            <td style="border: 1px solid #dee2e6; padding: 8px;">{{ item.å˜é€Ÿç®±|default:"-" }}</td>
                            <td style="border: 1px solid #dee2e6; padding: 8px;">{{ item.æ‰€åœ¨åœ°|default:"-" }}</td>
                        </tr>
                        {% empty %}
                        <tr>
                            <td colspan="8" style="border: 1px solid #dee2e6; padding: 20px; text-align: center; color: #6c757d;">æš‚æ— æ•°æ®</td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
            
            {% if total_count > 100 %}
            <div class="pagination-info" style="margin-top: 15px; padding: 10px; background-color: #e9ecef; border-radius: 3px;">
                <p style="margin: 0; color: #495057;">ğŸ“Š ä¸ºäº†é¡µé¢åŠ è½½æ€§èƒ½ï¼Œæ­¤å¤„ä»…æ˜¾ç¤ºå‰100æ¡æ•°æ®ã€‚è¦æŸ¥çœ‹å…¨éƒ¨ {{ total_count }} æ¡æ•°æ®ï¼Œè¯·ç‚¹å‡»ä¸Šæ–¹çš„"å¯¼å‡ºå…¨éƒ¨æ•°æ®åˆ°Excel"æŒ‰é’®ã€‚</p>
            </div>
            {% endif %}
            
            {% else %}
            <div class="no-data" style="text-align: center; padding: 40px; color: #6c757d;">
                <p>æš‚æ— çˆ¬å–æ•°æ®</p>
            </div>
            {% endif %}
        </div>
        
        <div class="submit-row">
            <a href="{% url 'admin:crawler_crawlertask_changelist' %}" class="button cancel-link">è¿”å›ä»»åŠ¡åˆ—è¡¨</a>
        </div>
    </div>
</div>

<style>
.info {
    background-color: #f8f9fa;
    padding: 15px;
    border-radius: 5px;
    margin-bottom: 20px;
}

.info ul {
    margin: 10px 0 0 0;
    padding-left: 20px;
}

.info li {
    margin-bottom: 5px;
}

.actions {
    background-color: #e9ecef;
    padding: 15px;
    border-radius: 5px;
    margin-bottom: 20px;
}

.data-summary {
    background-color: #d1ecf1;
    padding: 10px 15px;
    border-radius: 5px;
    margin-bottom: 10px;
    border-left: 4px solid #bee5eb;
}

.data-table {
    box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    border-radius: 5px;
    overflow: hidden;
}

.table th {
    font-weight: 600;
    color: #495057;
}

.table tbody tr:nth-child(even) {
    background-color: #f8f9fa;
}

.table tbody tr:hover {
    background-color: #e9ecef;
}
</style>
{% endblock %}